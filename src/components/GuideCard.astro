---
import LNFImage from './LNFImage.astro';
interface Props {
  href: string;
  title: string;
  description?: string;
  tag?: string;
  readingTime?: number;
  cover?: any; // String oder { src, ... }
}
const { href, title, description, tag, readingTime, cover } = Astro.props as Props;

function resolveSrc(c: any): string | undefined {
  if (!c) return undefined;
  if (typeof c === 'string') return c;
  if (typeof c.src === 'string') return c.src;
  if (typeof c.url === 'string') return c.url;
  if (typeof c.image?.src === 'string') return c.image.src;
  if (typeof c.default?.src === 'string') return c.default.src;
  return undefined;
}
const imgSrc = resolveSrc(cover);
---

<a
  href={href}
  class="group block h-full rounded-card overflow-hidden bg-surface border border-border/60 shadow-soft focus:outline-none focus:ring-2 focus:ring-[#7C9CFF]/60 flex flex-col"
>
  <!-- Gleiches Media-Ratio überall -->
  <div class="relative w-full aspect-[16/9] overflow-hidden">
    {imgSrc ? (
      <LNFImage
        src={imgSrc}
        alt={title}
        class="w-full h-full object-cover"
        priority={true}
      />
    ) : (
      <div class="w-full h-full bg-[#111624]"></div>
    )}
    <div class="pointer-events-none absolute inset-0 ring-1 ring-inset ring-black/10"></div>
  </div>

  <!-- Body füllt restliche Höhe -->
  <div class="p-4 flex flex-col gap-2 flex-1">
    <div class="flex items-center gap-2 text-xs text-text2">
      {tag && (
        <span class="inline-flex items-center rounded-full bg-[#68D391]/15 border border-[#68D391]/50 px-2 py-0.5 text-[11px] text-text">
          {tag}
        </span>
      )}
      {typeof readingTime === 'number' && readingTime > 0 && (
        <span class="text-text2">{readingTime} min read</span>
      )}
    </div>

    <!-- Titel & Description fix auf 2 Zeilen -->
    <h3 class="text-lg font-semibold leading-snug lc-2">
      {title}
    </h3>

    {description && (
      <p class="text-sm text-text2 lc-2">
        {description}
      </p>
    )}

    <!-- Spacer hält Footer-Bereich bündig -->
    <div class="flex-1"></div>
  </div>
</a>
