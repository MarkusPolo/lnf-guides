---
import { getCollection } from 'astro:content';

interface Props {
  currentSlug: string; // "dragons/best-starter-dragons"
  category: string;
}
const { currentSlug, category } = Astro.props as Props;

const items = (await getCollection('guides'))
  .filter((e) => e.data.category === category)
  .sort((a, b) => +new Date(a.data.pubDate) - +new Date(b.data.pubDate));

const idx = items.findIndex((e) => e.slug === currentSlug);
const prev = idx > 0 ? items[idx - 1] : null;
const next = idx >= 0 && idx < items.length - 1 ? items[idx + 1] : null;
---

{(prev || next) && (
  <nav class="mt-10 grid gap-4 sm:grid-cols-2">
    {prev && (
      <a href={`/guides/${prev.slug}/`} class="card p-4 block hover:bg-bg/60 border border-border/60">
        <div class="text-xs text-text2 mb-1">Previous</div>
        <div class="font-semibold">{prev.data.title}</div>
      </a>
    )}
    {next && (
      <a href={`/guides/${next.slug}/`} class="card p-4 block hover:bg-bg/60 border border-border/60 text-right sm:text-left sm:order-2">
        <div class="text-xs text-text2 mb-1">Next</div>
        <div class="font-semibold">{next.data.title}</div>
      </a>
    )}
  </nav>
)}
