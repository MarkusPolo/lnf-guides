---
interface Props {
  name?: string;
  height?: number;
  class?: string;
}
const { name = "slot", height = 180, class: cls = "" } = Astro.props as Props;
const id = `ad-${name.replace(/[^a-z0-9_-]/gi, "")}`;
---

<div id={id} class={`rounded-card border border-border/60 bg-[#0f1422] shadow-soft ${cls}`} style={`height:${height}px`}>
  <div class="text-xs text-text2 text-center pt-2">Ad placeholder: {name}</div>
</div>

<script>
  // @ts-nocheck
  (function () {
    const id = "{id}";

    function mountAd() {
      // Hier später echtes Ad-Netz einhängen (z. B. via script tag).
      // Aktuell nur Visualisierung: „aktiv“-Style
      const el = document.getElementById(id);
      if (!el) return;
      el.classList.add('ring-1','ring-emerald-500/40');
    }

    function unmountAd() {
      const el = document.getElementById(id);
      if (!el) return;
      el.classList.remove('ring-1','ring-emerald-500/40');
      // evtl. Ad-iframe entfernen etc.
    }

    function apply() {
      const allow = !!window.consent?.get?.()?.decisions?.ads;
      if (allow) mountAd();
      else unmountAd();
    }

    window.addEventListener('consent:updated', apply);
    document.addEventListener('DOMContentLoaded', apply);
  })();
</script>
